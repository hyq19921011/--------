<<<<<<< HEAD
C51 COMPILER V9.00   KEY                                                                   06/22/2015 20:45:58 PAGE 1   
=======
C51 COMPILER V9.00   KEY                                                                   06/05/2015 21:25:59 PAGE 1   
>>>>>>> parent of 838f16f... è¯´æ˜ï¼šä¿®æ”¹è‡³æœ€æ–°ï¼ŒæŒ‰é”®æœ‰å¤§çš„æ”¹åŠ¨ï¼Œå¢åŠ ä¿¡å·æ£€æµ‹ç«¯å£ã€‚


C51 COMPILER V9.00, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN .\Objects\key.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE source\key.c RTX51 OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\key.lst) OBJECT(.\Objects\key.obj)

line level    source

   1          #include "key.h"
   2          #include "usart.h"
   3          #include "delay.h"
   4          void Key_Init()
   5          {
   6   1                  P1M0 &= 0xcf;//³õÊ¼»¯P14¡¢ P15ÎªË«Ïò¿Ú
   7   1                      P1M1 &= 0xcf;
   8   1                      
   9   1      }
  10          
  11          /***************************
  12          º¯ÊıÃû³Æ£ºKey_Scan()
  13          ÊäÈë²ÎÊı£ºNULL
  14          ·µ»Ø²ÎÊı£º°´¼üÉ¨ÃèÖµ
  15          ¹¦ÄÜËµÃ÷£ºÉ¨Ãè°´¼üÊıÖµ²¢·µ»Ø¡£
  16          ****************************/
  17          unsigned char Key_Scan()
  18          {
  19   1       if(Key_Up == 0) //¼Ó
  20   1       {
  21   2                      return 1;
  22   2          
  23   2       }
  24   1       if(Key_Down == 0) //¼õ
  25   1       {
  26   2                      return 2;   
  27   2       }
  28   1       
  29   1       if(Key_Choose == 0)  //Ñ¡Ôñ
  30   1       {      
  31   2                      return 3;
  32   2        
  33   2       }
  34   1       if(Key_Debug == 0)  //Ñ¡Ôñ
  35   1       {      
  36   2                      return 4;
  37   2        
  38   2       }
  39   1       return 0;    //Ã»ÓĞ¼ü°´ÏÂ Ëæ±ã¸øµÄÊıÖµÃ»ÌØÊâÒâÒå
  40   1      }
  41          
  42          BYTE read_key(u8* pKeyValue)               
  43          {  
  44   1          static u8  s_u8keyState=0;        //Î´°´£¬ÆÕÍ¨¶Ì°´£¬³¤°´£¬Á¬·¢  
  45   1          static u16 s_u16keyTimeCounts=0;  //Î´ÔÚ¼ÆÊ±×´Ì¬µÄ¼ÆÊıÆ÷
  46   1          static u8  s_u8LastKey = key_up ; //ÀúÊ·Êı¾İ
  47   1        
  48   1          u8 keyTemp=0;               //¼ü¶ÔÓ¦ioµÄµçÆ½  
  49   1          u8 key_return=0;            //º¯Êı·µ»ØÖµ 
  50   1          keyTemp=Key_Scan();  //ÌáÈ¡ËùÓĞkey¶ÔÓ¦µÄio¿Ú  
  51   1              Delay_nms(1);
  52   1          switch(s_u8keyState)           //ÕâÀï¼ì²âµ½µÄÊÇÏÈÇ°µÄ×´Ì¬£¬¼´ÎŞ¶¯×÷ 
  53   1          {  
  54   2              case state_keyUp:   //Èç¹ûÏÈÇ°ÊÇ³õÊ¼Ì¬  
<<<<<<< HEAD
C51 COMPILER V9.00   KEY                                                                   06/22/2015 20:45:58 PAGE 2   
=======
C51 COMPILER V9.00   KEY                                                                   06/05/2015 21:25:59 PAGE 2   
>>>>>>> parent of 838f16f... è¯´æ˜ï¼šä¿®æ”¹è‡³æœ€æ–°ï¼ŒæŒ‰é”®æœ‰å¤§çš„æ”¹åŠ¨ï¼Œå¢åŠ ä¿¡å·æ£€æµ‹ç«¯å£ã€‚

  55   2              {  
  56   3                  if(keyTemp!=key_up) //Èç¹û¼ü±»°´ÏÂ
  57   3                  {  
  58   4                      s_u8keyState=state_keyDown; //¸üĞÂ¼üµÄ×´Ì¬£¬ÆÕÍ¨±»°´ÏÂ  
  59   4                  }  
  60   3              }  
  61   2              break;  
  62   2                
  63   2              case state_keyDown: //Èç¹ûÏÈÇ°ÊÇ±»°´×ÅµÄ  
  64   2              {  
  65   3                  if(key_up!=keyTemp) //Èç¹ûÏÖÔÚ»¹ÊÇ±»°´×Å  
  66   3                  {  
  67   4                      s_u8keyState=state_keyTime; //×ª»»µ½¼ÆÊ±Ì¬  
  68   4                      s_u16keyTimeCounts=0;  
  69   4                      s_u8LastKey = keyTemp;     //±£´æ¼üÖµ  
  70   4                  }  
  71   3                  else  
  72   3                  {  
  73   4                      s_u8keyState=state_keyUp; //¼üÃ»±»°´×Å£¬»Øµ½³õÊ¼Ì¬£¬ËµÃ÷ÊÇ¸ÉÈÅ  
  74   4                  }  
  75   3              }  
  76   2              break;  
  77   2                
  78   2              case state_keyTime:  //Èç¹ûÏÈÇ°ÒÑ¾­×ª»»µ½¼ÆÊ±Ì¬  
  79   2              {  //Èç¹ûÕæÊÇÊÖ¶¯°´¼ü£¬±ØÈ»½øÈëµ½±¾´úÂë¿é£¬²¢ÇÒ»á¶à´Î½øÈë  
  80   3                  if(key_up==keyTemp) //Èç¹ûÎ´°´¼ü 
  81   3                  {  
  82   4                      s_u8keyState=state_keyUp;   
  83   4                      key_return=return_keyPressed;    //·µ»Ø2£¬Ò»´ÎÍêÕûµÄÆÕÍ¨°´¼ü 
  84   4                      //³ÌĞò½øÈëÕâ¸öÓï¾ä¿é£¬ËµÃ÷ÒÑ¾­ÓĞ2´ÎÒÔÉÏ10MSµÄÖĞ¶Ï£¬µÈÓÚÒÑ¾­Ïû¶¶ 
  85   4                      //ÄÇÃ´´ËÊ±¼ì²âµ½°´¼ü±»ÊÍ·Å£¬ËµÃ÷ÊÇÒ»´ÎÆÕÍ¨µÄ¶Ì°´  
  86   4                  }  
  87   3                  else  //ÔÚ¼ÆÊ±×´Ì¬£¬¼ì²âµ½¼ü»¹±»°´×Å  
  88   3                  {  
  89   4                      if(++s_u16keyTimeCounts>key_longTimes) //Ê±¼ä´ïµ½2Ãë  
  90   4                      {  
  91   5                          s_u8keyState=state_keyLong;  //½øÈë²ú°´¼ü×´Ì¬  
  92   5                          s_u16keyTimeCounts=0;        //¼¼ÊõÆ÷ÇåÁã£¬±ãÓÚ½øÈëÁ¬·¢ÖØĞÂ¼ÆÊı  
  93   5                          key_return=return_keyLong;   //·µ»Østate_keyLong  
  94   5                      }  
  95   4                 
  96   4                  }  
  97   3              }  
  98   2              break;  
  99   2                
 100   2              case state_keyLong:  //ÔÚ³¤°²×´Ì¬¼ì²âÁ¬·¢ ,Ã¿0.2Ãë·¢Ò»´Î 
 101   2              {  
 102   3                  if(key_up==keyTemp)   
 103   3                  {  
 104   4                     s_u8keyState=state_keyUp;   
 105   4                  }  
 106   3                  else //°´¼üÊ±¼ä³¬¹ı2ÃëÊ± 
 107   3                  {  
 108   4                      if(++s_u16keyTimeCounts>key_autoTimes)//10*key_autoTimes
 109   4                      {  
 110   5                          s_u16keyTimeCounts=0;  
 111   5                          key_return=return_keyAuto;  //Ã¿0.2Ãë·µ»ØÖµµÄµÚ¶şÎ»ÖÃÎ»  
 112   5                      }//Á¬·¢µÄÊ±ºò°éËæ×Å³¤°´  
 113   4                  }  
 114   3                  key_return |= return_keyLong;  //0x02????,0x04|0x02????  
 115   3              }  
 116   2              break;  
<<<<<<< HEAD
C51 COMPILER V9.00   KEY                                                                   06/22/2015 20:45:58 PAGE 3   
=======
C51 COMPILER V9.00   KEY                                                                   06/05/2015 21:25:59 PAGE 3   
>>>>>>> parent of 838f16f... è¯´æ˜ï¼šä¿®æ”¹è‡³æœ€æ–°ï¼ŒæŒ‰é”®æœ‰å¤§çš„æ”¹åŠ¨ï¼Œå¢åŠ ä¿¡å·æ£€æµ‹ç«¯å£ã€‚

 117   2                
 118   2              default:  
 119   2              break;  
 120   2          }  
 121   1          *pKeyValue = s_u8LastKey ; //·µ»Ø¼üÖµ 
 122   1          return key_return;  
 123   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    193    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
